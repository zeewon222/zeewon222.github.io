import * as React from "react"
import { useMemo } from "react"
import { emptyStateStyle } from "./constants"

/*
 ** ICON UTILS
 ** Pull as much re-usable logic into here as possible
 ** This will make it easier to replace in all icon components
 */

const findByArray = (arr: any[], search: string) => arr.find(a => a.toLowerCase().includes(search))

export function useIconSelection<T>(Icons, selectByList, iconSearch = "", iconSelection): T {
    // Setup icon keys for searching
    const iconKeys = Object.keys(Icons)
    const lowercaseIconKeyPairs = useMemo(
        () =>
            iconKeys.reduce((res, key) => {
                res[key.toLowerCase()] = key
                return res
            }, {}),
        [iconKeys]
    )

    // Clean search term
    const iconSearchResult = useMemo(() => {
        if (iconSearch == null || iconSearch?.length === 0) return null

        const iconSearchTerm = iconSearch.toLowerCase().split("-").join("")

        // check for exact match, otherwise use .find
        const searchResult = lowercaseIconKeyPairs[iconSearchTerm] ?? findByArray(iconKeys, iconSearchTerm)

        return searchResult
    }, [iconKeys, iconSelection, iconSearch])

    const name = selectByList ? iconSelection : iconSearchResult

    return Icons[name]
}

const nullIconStyle: React.CSSProperties = {
    minWidth: "10px",
    minHeight: "10px",
    maxWidth: "20px",
    maxHeight: "20px",
    width: "60%",
    height: "60%",
}

export function NullState() {
    return (
        <div style={emptyStateStyle}>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" style={nullIconStyle}>
                <path
                    d="M 12.857 0 C 19.958 0 25.714 5.756 25.714 12.857 C 25.714 19.958 19.958 25.714 12.857 25.714 C 5.756 25.714 0 19.958 0 12.857 C 0 5.756 5.756 0 12.857 0 Z"
                    fill="#FFFFFF"
                ></path>
                <path
                    d="M 20.357 20.357 L 27.857 27.857"
                    fill="transparent"
                    stroke-width="4.28"
                    stroke="#FFFFFF"
                    stroke-linecap="round"
                ></path>
                <g transform="translate(9.643 6.429)">
                    <path
                        d="M 3.214 12.857 L 3.214 12.857"
                        fill="transparent"
                        stroke-width="3.75"
                        stroke="#8A58FF"
                        stroke-linecap="round"
                    ></path>
                    <path
                        d="M 0 3.214 C 0 1.004 1.843 0 3.214 0 C 4.586 0 6.429 0.603 6.429 3.214 C 6.429 5.826 3.214 5.913 3.214 7.232 C 3.214 8.552 3.214 8.571 3.214 8.571"
                        fill="transparent"
                        stroke-width="3.22"
                        stroke="#8A58FF"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    ></path>
                </g>
            </svg>
        </div>
    )
}
